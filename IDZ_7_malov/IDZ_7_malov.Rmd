---
title: "IDZ 1"
author: "Nikita Fiodorov"
date: "21.04.17"
output:
  html_document:
    keep_md: yes
    output: null
    toc_float: yes0
  pdf_document:
    keep_tex: yes
    toc: yes
  word_document: default
  github_document: rmarkdown::github_document
params:
  bibliography: bibl.bib
  urlcolor: blue
---

```{r setup, include=FALSE}
library(dplyr)
library(tidyr)
library(xtable)
library(ggvis)
library(ggplot2)
set.seed(100);
options(scipen = 0, digits = 3)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE,fig.path = "README_figs/README-")
```

Распределение в файле: [file]()

### Выполнение работы

```{r func}
#init
  set.seed(100);
  #   выборочный эксцесс
  exc = function(x){
    sum((x-mean(x))^4)/length(x)/var(x)^2-3;
  }
  #   выборочную асимметрию
  asm = function(x){
    sum((x-mean(x))^3)/length(x)/var(x)^(3/2)
  }
  #   все характеристики
  allProp = function(x){ data.frame(mean = mean(x),var = var(x),median  = median(x),asm = asm(x),exc = exc(x))}
  
```


Необходимо для каждого распределения:

**a.	**

```{r }
  #a.
  #чтение
  a_1 = 0.02; a = 0.00; b = 5.79; lamda_0 = 4.00; lamda_1 = 6.00
  PuasDistr = as.vector(read.table("puas.txt",sep = " ",dec = "."),mode = "double");
  distributions = list(PuasDistr=PuasDistr);
  
```
**	вариационный ряд**
```{r }
  #вариационный ряд
  sort(PuasDistr)
```
**	построить по данной выборке эмпирическую функцию распределения;**

Эмпирическая функция распределения в каждой точке принимает значение отношения числа наблюдений меньше этой точки к общему числу наблюдений.
$$\hat{F}_m(x)\;=\;\frac{1}{m}\sum_{i=1}^m I_{\left\{x_i\leq x\right\}}.$$

<h2 align="center">Эмпирические</h2>

```{r }
  #эмпирическую функцию распределения
  lapply(distributions,FUN = plot.ecdf,col.01line = "red",col="green")
```



<p align="right"><b>Выводы:</b></p>
<p align="right">Эмпирическую функцию можно рассматривать как состоятельную оценку теоретической функции распределения </p><p align="right">т.к. по усиленному закону больших чисел $\hat{F}_m(x)$ сходится почти наверное к теоретической функции распределения $F(x):\hat{F}_m(x)\to F(x)$ почти наверное при $m \rightarrow \infty$.</p>
----

**	построить гистограмму частот;**

Пусть $X_{1},\ldots ,X_{n},\ldots$  — выборка из некоторого распределения. Определим разбиение числовой прямой ${\displaystyle -\infty <a_{0}<a_{1}<\cdots <a_{k-1}<a_{k}<\infty }$. Пусть ${\displaystyle n_{i}=\sum \limits _{j=1}^{n}\mathbf {1} _{\{X_{j}\in (a_{i-1},a_{i}]\}},\;\quad i=1,\ldots ,k}$
— число элементов выборки, попавших в ${\displaystyle i}$-й интервал. Тогда кусочно-постоянная функция ${\displaystyle {\tilde {h}}:\mathbb {R} \to \mathbb {R} }$, имеющая вид:

${\displaystyle {\tilde {h}}(x)={\frac {n_{i}}{n\Delta a_{i}}},\Delta a_{i}=a_{i}-a_{i-1},\;i=1,\ldots ,k\;}$, — называется нормализованной гистограммой.

```{r }
#гистограмму частот;
  hist(PuasDistr, 
       breaks = 20,
       freq = F, 
       col = "lightblue",
       xlab = "Диаметр юбки",
       ylab = "Плотность вероятности",
       main = "PuasDistr Гистограмма"
  )
```

**b. Вычислить выборочные аналоги следующих числовых характеристик:**
**все характеристики**
```{r }
#b.
  #все характеристики
  distributionsProp = t(sapply(distributions,allProp))
  distributionsProp

```

**Вероятность попадания в интервал**

```{r }
#Вероятность попадания в интервал (percentiles for x)
  pPuasDistr <- ecdf(PuasDistr) # эмпир функц
  pPuasDistr
```
**процентили и вероятность**
```{r }
  pPuasDistr(PuasDistr)  # процентили
  pPuas = function(a,b){pPuasDistr(b) - pPuasDistr(a)}
  pPuas(a,b)

```

с) В предположении, что исходные наблюдения являются выборкой из распределения Пуассона, построить оценку максимального правдоподобия параметра λ, а также оценку λ по методу моментов. Найти смещение оценок.

Метод моментов:
Пусть случайная величина (вектор, матрица и т. д.) X имеет некоторое распределение ${\displaystyle \mathbb {P} _{\theta }}$, зависящее от параметров ${\displaystyle \theta \in \Theta \subset \mathbb {R} ^{k}}$ Пусть для функций (называемых моментами или моментными функциями) ${\displaystyle g_{i}:\mathbb {R} ^{m}\to \mathbb {R} } $, интегрируемых по мере ${\displaystyle \mathbb {P} _{\theta }}$, выполнены условия на моменты

${\displaystyle \mathbb {E} \left[g_{i}(X,\theta )\right]=0~,~~i=1..k}$
Пусть ${\displaystyle X_{1},\ldots ,X_{n}}$ — выборка случайной величины X. Предполагается, что соотношения аналогичные условиям на моменты выполнены и для выборки, а именно вместо математического ожидания в условиях на моменты необходимо использовать выборочные средние:

${\displaystyle {\overline {g_{i}(X,\theta )}}=0~,~~i=1..k}$
причем в данном представлении (когда справа от равенства — ноль) достаточно использовать просто суммы вместо средних.

Оценки, получаемые из решения этой системы уравнений (выборочных условий на моменты), называются оценками метода моментов. Название метода связано с тем, что чаще всего в качестве функций ${\displaystyle g_{i}}$ выступают функции степенного вида, математические ожидания от которых в теории вероятностей и математической статистике принято называть моментами.

Если моментные функции непрерывны, то оценки метода моментов состоятельны.




