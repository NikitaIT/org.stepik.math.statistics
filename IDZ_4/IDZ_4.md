# IDZ_4
Nikita  
22.04.17  




#Проверка простых гипотез согласия.



Порядок работы:

1.   Загрузить данные “zz_norm_x.csv” [ find]()
      
      1.1   Провести тестирование и анализ работы алгоритма. [ find]()
            
      -   Сгенерировать выборки длины $10, 100, 1000, 10^{4}$ из нормального распределения.[find]()
        
      -   Гипотезы $H_0=\{ \mu = -23 \}$, $H_1=\{ \mu \neq -23 \}$ и уровни $\alpha = 0.25, 0.1, 0.05, 0.01, 0.001$ [ find]() 
        
      -   Построить  и применить следующие критерии проверки простой гипотезы согласия $H_0$: [ find]()
            
          a.   с известной дисперсией (той, которую задали при генерации) [ find]()
                
          b.   с неизвестной [ find]()
                
      -   Вычислить пороговое значение $С$ для каждого $\alpha$. [ find]()
        
      -   Выписать общую формулу для критерия и формулу для вычисления $С$. [ find]()
        
      -   Вычислить значения статистики отклонения для выборки, сравнить с пороговым значением, и сделать          вывод: отвергнуть гипотезу на данном уровне значимости, или же данные не противоречат гипотезе.[find]()
        
      -   Провести анализ зависимости результата от уровня $\alpha$. [ find]()
        
      -   Вычислить реально достигнутый уровень значимости. Интерпретировать его. [ find]()
        
      -   Провести анализ зависимости результатов от длины выборки. [ find]()
    
    1.2  Пусть при генерации вы взяли среднее a. Проделать пункт 1.1. для гипотез:  $H_0=\{ \mu = \alpha + \epsilon \}$, где $\epsilon = 10, 0.1, 0.01, 0$. Интерпретировать зависимость от $\epsilon$. [ find]()

2.  Предполагаем, что в файле выборка $N(\mu = x, sd = 1)$. Необходимо проделать пункты a,b,d из задания 1.1. для данной выборки(уровни в пунктах a и b те же) Интерпретировать полученные результаты. [ find]()

3.   Проделать пункт 1.1.  для задачи о проверки простой гипотезы согласия о параметрах распределения Бернулли (генерируете выборку со своим параметром $p$; берете те же уровни) ${\mathbb  {P}}(X=1)=p, {\displaystyle \mathbb {P} (X=0)=q}$ [ find]()

4.   Проделать пункт 1.2  для задачи о проверки простой гипотезы согласия о параметрах распределения Бернулли (для $\epsilon = 0.2, 0.1, 0.01$; следите, чтобы сумма $p+ \epsilon < 1$) [ find]()

5.   Вспомнить результаты вашего построения ДИ на базе ОМП.  Проверить и протестировать (аналогично 1.1 и 1.2) критерии проверки простой гипотезы согласия, основанные на этих ДИ. [ find]()



##Прикидка

Основные характеристики

```
##      x     x10   x100   x1000   x10000  
## mean -23.6 -23.1 -23    -22.9   -23     
## var  0.497 7.87  27.2   26.4    24.5    
## asm  0.401 0.18  0.171  -0.0802 -0.00753
## exc  1.93  -1.42 -0.247 0.0925  0.0471
```

Нас больше всего интересует среднее.

```
##      x    x10   x100  x1000 x10000 
##  -23.6  -23.1  -23.0  -22.9  -23.0
```
И дисперсия.

```
##      x    x10   x100  x1000 x10000 
##  0.497  7.871 27.217 26.369 24.475
```

#### 1.1 a. Построить  и применить критерии проверки простой гипотезы согласия $H_0$: с известной дисперсией (той, которую задали при генерации)
Имеется выборка $X = (X_1, . . . , X_n)$ из нормального распределения $N_{a,\sigma ^2}$ с известной дисперсией $\sigma^2$. Проверяется простая гипотеза $H_1 = \{a = m\}$ против сложной альтернативы $H_2 = \{a \neq m\}$.

Построим критерий точного размера $\epsilon$ с помощью функции отклонения
$$p(X)={\frac {{\overline {X}}-m}{s_{X}/{\sqrt {n}}}}$$.

Очевидно свойство $K_1(а)$: если $H_1$ верна, то $p(X)$ имеет стандартное нормальное
распределение.

По $\epsilon$ выберем $C = \tau_{1−\epsilon/2}$ — квантиль стандартного нормального распределения. Тогда $$\epsilon = P_{H_1} (|p(X)| > C)$$.

Критерий выглядит так:

$$\delta (X) = \{H_1, если |p(X)| < C;  H_2, если |ρ(X)| > C\}$$

*1. для сгенерированных распределений*

```
## [[1]]
##        possible_mean statistic levels p_value 
## x10    -13           -6.38     List,3 1.76e-10
## x100   -13           -20       List,3 5.54e-89
## x1000  -13           -62.5     List,3 0       
## x10000 -13           -200      List,3 0       
## 
## [[2]]
##        possible_mean statistic levels p_value
## x10    -22.9         -0.12     List,3 0.904  
## x100   -22.9         -0.2      List,3 0.842  
## x1000  -22.9         0.0933    List,3 0.926  
## x10000 -22.9         -2.36     List,3 0.0181 
## 
## [[3]]
##        possible_mean statistic levels p_value
## x10    -23           -0.0631   List,3 0.95   
## x100   -23           -0.0197   List,3 0.984  
## x1000  -23           0.662     List,3 0.508  
## x10000 -23           -0.565    List,3 0.572  
## 
## [[4]]
##        possible_mean statistic levels p_value
## x10    -23           -0.0568   List,3 0.955  
## x100   -23           0.00034   List,3 1      
## x1000  -23           0.726     List,3 0.468  
## x10000 -23           -0.365    List,3 0.715
```
По уровням.

```
## $x10
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x100
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x1000
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10000
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10
##   critical_value a_levels success
## 1        0.31864    0.750    TRUE
## 2        0.12566    0.900    TRUE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x100
##   critical_value a_levels success
## 1        0.31864    0.750    TRUE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x1000
##   critical_value a_levels success
## 1        0.31864    0.750    TRUE
## 2        0.12566    0.900    TRUE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10000
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10
##   critical_value a_levels success
## 1        0.31864    0.750    TRUE
## 2        0.12566    0.900    TRUE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x100
##   critical_value a_levels success
## 1        0.31864    0.750    TRUE
## 2        0.12566    0.900    TRUE
## 3        0.06271    0.950    TRUE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x1000
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10000
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
```

#### 1.1 b. Построить  и применить критерии проверки простой гипотезы согласия $H_0$: с неизвестной дисперсией.
                
Используем Одновыборочный t-критерий.

Он применяется для проверки нулевой гипотезы ${\displaystyle H_{0}:E(X)=m}$ о равенстве математического ожидания ${\displaystyle E(X)}$ некоторому известному значению ${\displaystyle m}$.

Очевидно, при выполнении нулевой гипотезы ${\displaystyle E({\overline {X}})=m}$. С учётом предполагаемой независимости наблюдений ${\displaystyle V({\overline {X}})=\sigma ^{2}/n}$. Используя несмещенную оценку дисперсии ${\displaystyle s_{X}^{2}=\sum _{t=1}^{n}(X_{t}-{\overline {X}})^{2}/(n-1)}$ получаем следующую t-статистику:

$${\displaystyle t={\frac {{\overline {X}}-m}{s_{X}/{\sqrt {n}}}}}$$

При нулевой гипотезе распределение этой статистики ${\displaystyle t(n-1)}$. Следовательно, при превышении значения статистики по абсолютной величине критического значения данного распределения (при заданном уровне значимости) нулевая гипотеза отвергается.

*1. для сгенерированных распределений*

```
## [[1]]
##        possible_mean statistic levels p_value 
## x10    -13           -11.4     List,3 1.22e-06
## x100   -13           -19.2     List,3 4.31e-35
## x1000  -13           -60.9     List,3 0       
## x10000 -13           -203      List,3 0       
## 
## [[2]]
##        possible_mean statistic levels p_value
## x10    -22.9         -0.214    List,3 0.835  
## x100   -22.9         -0.191    List,3 0.849  
## x1000  -22.9         0.0908    List,3 0.928  
## x10000 -22.9         -2.39     List,3 0.0169 
## 
## [[3]]
##        possible_mean statistic levels p_value
## x10    -23           -0.112    List,3 0.913  
## x100   -23           -0.0188   List,3 0.985  
## x1000  -23           0.645     List,3 0.519  
## x10000 -23           -0.571    List,3 0.568  
## 
## [[4]]
##        possible_mean statistic levels p_value
## x10    -23           -0.101    List,3 0.922  
## x100   -23           0.000326  List,3 1      
## x1000  -23           0.707     List,3 0.48   
## x10000 -23           -0.368    List,3 0.713
```
Видим, что для имеющихся выборочных данных t-критерий составляет $statistic$ при $x\{N-1\}$ степенях свободы (df). Вероятность получить такое (либо большее) значение t при условии, что проверяемая нулевая гипотеза верна, оказалась весьма высока: $p\_value$. Следовательно, мы можем принять проверяемую нулевую гипотезу о равенстве выборочного среднего значения нормативу и отклонить альтернативную гипотезу. Делая это, мы рискуем ошибиться с вероятностью менее $1-a\_levels$.

```
## $x10
##   critical_value a_levels success
## 1        0.32857    0.750   FALSE
## 2        0.12925    0.900   FALSE
## 3        0.06448    0.950   FALSE
## 4        0.01289    0.990   FALSE
## 5        0.00129    0.999   FALSE
## 
## $x100
##   critical_value a_levels success
## 1        0.31953    0.750   FALSE
## 2        0.12598    0.900   FALSE
## 3        0.06287    0.950   FALSE
## 4        0.01257    0.990   FALSE
## 5        0.00126    0.999   FALSE
## 
## $x1000
##   critical_value a_levels success
## 1        0.31873    0.750   FALSE
## 2        0.12569    0.900   FALSE
## 3        0.06272    0.950   FALSE
## 4        0.01254    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10000
##   critical_value a_levels success
## 1        0.31865    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10
##   critical_value a_levels success
## 1        0.32857    0.750    TRUE
## 2        0.12925    0.900   FALSE
## 3        0.06448    0.950   FALSE
## 4        0.01289    0.990   FALSE
## 5        0.00129    0.999   FALSE
## 
## $x100
##   critical_value a_levels success
## 1        0.31953    0.750    TRUE
## 2        0.12598    0.900   FALSE
## 3        0.06287    0.950   FALSE
## 4        0.01257    0.990   FALSE
## 5        0.00126    0.999   FALSE
## 
## $x1000
##   critical_value a_levels success
## 1        0.31873    0.750    TRUE
## 2        0.12569    0.900    TRUE
## 3        0.06272    0.950   FALSE
## 4        0.01254    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10000
##   critical_value a_levels success
## 1        0.31865    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10
##   critical_value a_levels success
## 1        0.32857    0.750    TRUE
## 2        0.12925    0.900    TRUE
## 3        0.06448    0.950   FALSE
## 4        0.01289    0.990   FALSE
## 5        0.00129    0.999   FALSE
## 
## $x100
##   critical_value a_levels success
## 1        0.31953    0.750    TRUE
## 2        0.12598    0.900    TRUE
## 3        0.06287    0.950    TRUE
## 4        0.01257    0.990   FALSE
## 5        0.00126    0.999   FALSE
## 
## $x1000
##   critical_value a_levels success
## 1        0.31873    0.750   FALSE
## 2        0.12569    0.900   FALSE
## 3        0.06272    0.950   FALSE
## 4        0.01254    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10000
##   critical_value a_levels success
## 1        0.31865    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10
##   critical_value a_levels success
## 1        0.32857    0.750    TRUE
## 2        0.12925    0.900    TRUE
## 3        0.06448    0.950   FALSE
## 4        0.01289    0.990   FALSE
## 5        0.00129    0.999   FALSE
## 
## $x100
##   critical_value a_levels success
## 1        0.31953    0.750    TRUE
## 2        0.12598    0.900    TRUE
## 3        0.06287    0.950    TRUE
## 4        0.01257    0.990    TRUE
## 5        0.00126    0.999    TRUE
## 
## $x1000
##   critical_value a_levels success
## 1        0.31873    0.750   FALSE
## 2        0.12569    0.900   FALSE
## 3        0.06272    0.950   FALSE
## 4        0.01254    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## $x10000
##   critical_value a_levels success
## 1        0.31865    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
```


1) Значения статистики отклонения меньше, когда известна дисперсия и больше в противном случае. С увиличением обьема выборки зависимость слабеет.

2) Очевидно, что чем больше $e$, тем больше значение статистики отклонения и тем меньше вероятность принятия основной гипотезы.




2.  Предполагаем, что в файле выборка $N(\mu = x, sd = 1)$. Необходимо проделать пункты a,b,d из задания 1.1. для данной выборки(уровни в пунктах a и b те же) Интерпретировать полученные результаты.


```
##               x       
## possible_mean -23.8   
## statistic     6.79    
## levels        List,3  
## p_value       1.96e-11
```

```
## [[1]]
##   critical_value a_levels success
## 1        0.31873    0.750   FALSE
## 2        0.12569    0.900   FALSE
## 3        0.06272    0.950   FALSE
## 4        0.01254    0.990   FALSE
## 5        0.00125    0.999   FALSE
```

```
##               x       
## possible_mean -23.8   
## statistic     4.79    
## levels        List,3  
## p_value       1.71e-06
```

```
## [[1]]
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
```

3.   Проделать пункт 1.1.  для задачи о проверки простой гипотезы согласия о параметрах распределения Бернулли (генерируете выборку со своим параметром $p$; берете те же уровни) ${\mathbb  {P}}(X=1)=p, {\displaystyle \mathbb {P} (X=0)=q}$

По теореме Муавра-Лапласа, с ростом n форма биномиальной фигуры распределения становится похожа на плавную кривую Гаусса.


```
## [[1]]
##      possible_prob statistic levels p_value
## [1,] 0.2           -3.25     List,3 0.00115
## 
## [[2]]
##      possible_prob statistic levels p_value
## [1,] 0.11          -1.28     List,3 0.201  
## 
## [[3]]
##      possible_prob statistic levels p_value
## [1,] 0.1           -1        List,3 0.317
```

```
## [[1]]
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## [[2]]
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## [[3]]
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
```

4.   Проделать пункт 1.2  для задачи о проверки простой гипотезы согласия о параметрах распределения Бернулли (для $\epsilon = 0.2, 0.1, 0.01$; следите, чтобы сумма $p+ \epsilon < 1$)


```
## [[1]]
##      possible_prob statistic levels p_value 
## [1,] 0.3           -5.02     List,3 5.19e-07
## 
## [[2]]
##      possible_prob statistic levels p_value
## [1,] 0.2           -3.25     List,3 0.00115
## 
## [[3]]
##      possible_prob statistic levels p_value
## [1,] 0.11          -1.28     List,3 0.201
```

```
## [[1]]
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## [[2]]
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
## 
## [[3]]
##   critical_value a_levels success
## 1        0.31864    0.750   FALSE
## 2        0.12566    0.900   FALSE
## 3        0.06271    0.950   FALSE
## 4        0.01253    0.990   FALSE
## 5        0.00125    0.999   FALSE
```

Проверим работает ли это вообще, на идеальной выборке.

```
## [1] 10
```

```
##      possible_prob statistic levels p_value
## [1,] 0.1           0         List,3 1
```

```
## [[1]]
##   critical_value a_levels success
## 1        0.31864    0.750    TRUE
## 2        0.12566    0.900    TRUE
## 3        0.06271    0.950    TRUE
## 4        0.01253    0.990    TRUE
## 5        0.00125    0.999    TRUE
```

Сверим стандартный тест Стьюдента и наш.

```
##             x10                 x100                x1000              
## statistic   -0.101              0.000326            0.707              
## parameter   9                   99                  999                
## p.value     0.922               1                   0.48               
## conf.int    Numeric,2           Numeric,2           Numeric,2          
## estimate    -23.1               -23                 -22.9              
## null.value  -23                 -23                 -23                
## alternative "two.sided"         "two.sided"         "two.sided"        
## method      "One Sample t-test" "One Sample t-test" "One Sample t-test"
## data.name   "X[[i]]"            "X[[i]]"            "X[[i]]"           
##             x10000             
## statistic   -0.368             
## parameter   9999               
## p.value     0.713              
## conf.int    Numeric,2          
## estimate    -23                
## null.value  -23                
## alternative "two.sided"        
## method      "One Sample t-test"
## data.name   "X[[i]]"
```

```
##             x                  
## statistic   6.79               
## parameter   999                
## p.value     1.96e-11           
## conf.int    Numeric,2          
## estimate    -23.6              
## null.value  -23.8              
## alternative "two.sided"        
## method      "One Sample t-test"
## data.name   "X[[i]]"
```
  
