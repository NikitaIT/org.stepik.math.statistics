install.packages("stargazer");
exc<<-function(x){
sum((x-mean(x))^4)/length(x)/var(x)^2-3;
}
asm <<- function(x){
sum((x-mean(x))^3)/length(x)/var(x)^(3/2)
}
allProp <<- function(x){ data.frame(mean = mean(x),var = var(x),asm = asm(x),exc = exc(x))}
empiricalFun<<-function(x,t){z<-x[x<t]; length(z)/length(x)}
empiricalPlot<<-function(x){
xu<-unique(sort(x));
yu<-0;
for(i in 1:length(xu)) yu[i]<-empiricalFun(x,xu[i]);
yu[length(xu)+1]<-1
z<-stepfun(xu,yu);
plot.ecdf(z,col.01line = "red",col="green",main = "plotE");
}
funP
rG <<- rgamma(n = n, shape = 10, rate = 5.3);
rN <<- rnorm(n = n, mean = 2.3, sd = 0.3);
rNB <<- rnbinom(n = n, size = 32,prob = 1/5);
funP <<- list(G = {function(x){ pgamma(q = x, shape = 10, rate = 5.3);}},
N = {function(x){ pnorm(q = x, mean = 2.3, sd = 0.3);}},
NB = {function(x){ pnbinom(q = x, size = 32,prob = 1/5);}}
);
funP
empiricalPlot(AnnualDiameter$AnnualDiameter);
exc<<-function(x){
sum((x-mean(x))^4)/length(x)/var(x)^2-3;
}
asm <<- function(x){
sum((x-mean(x))^3)/length(x)/var(x)^(3/2)
}
allProp <<- function(x){ data.frame(mean = mean(x),var = var(x),asm = asm(x),exc = exc(x))}
empiricalPlot<<-function(x){
xu<-unique(sort(x));
yu<-0;
for(i in 1:length(xu)) yu[i]<-empiricalFun(x,xu[i]);
yu[length(xu)+1]<-1
z<-stepfun(xu,yu);
plot.ecdf(z,col.01line = "red",col="green",main = "plotE");
}
init <- function(){
AnnualDiameter<<-as.data.frame(read.csv("IDZ_1/annual-diameter-of-skirt-at-hem-.csv",col.names = c("AnnualDiameter")));
#a.	сгенерировать выборку длины 1000 из данного распределения (стр. 19)
n <- 1000;
rG <<- rgamma(n = n, shape = 10, rate = 5.3);
rN <<- rnorm(n = n, mean = 2.3, sd = 0.3);
rNB <<- rnbinom(n = n, size = 32,prob = 1/5);
#   значения функции распределения в точке x
funP <<- list(G = {function(x){ pgamma(q = x, shape = 10, rate = 5.3);}},
N = {function(x){ pnorm(q = x, mean = 2.3, sd = 0.3);}},
NB = {function(x){ pnbinom(q = x, size = 32,prob = 1/5);}}
);
}
init();
hist(AnnualDiameter$AnnualDiameter,
breaks = 20,
freq = F,
col = "lightblue",
xlab = "Темпиратура",
ylab = "Плотность вероятности",
main = "Гистограмма, с кривой плотности Темпиратуры"
);
AnnualDiameterProp <- allProp(AnnualDiameter$AnnualDiameter);
write.csv(AnnualDiameterProp,file = "AnnualDiameterProp.csv")
bildEmpiricalPlots <- function(){
empiricalPlot(rG);
empiricalPlot(rN);
empiricalPlot(rNB);
}
empiricalPlot(AnnualDiameter$AnnualDiameter);
empiricalFun<<-function(x,t){z<-x[x<t]; length(z)/length(x)}
